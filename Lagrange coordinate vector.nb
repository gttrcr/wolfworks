(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29627,        700]
NotebookOptionsPosition[     28431,        671]
NotebookOutlinePosition[     28901,        689]
CellTagsIndexPosition[     28858,        686]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<DarkMode\>\"", "]"}], "[", "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<TensoriaCalc.m\>\""}], "//", 
  "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VarName", "[", 
   RowBox[{"var_", ",", " ", "index_"}], "]"}], ":=", 
  RowBox[{"ToExpression", "[", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"ToString", "[", "var", "]"}], ",", " ", 
     RowBox[{"ToString", "[", "index", "]"}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Par", "[", "index_", "]"}], ":=", 
   RowBox[{"VarName", "[", 
    RowBox[{"\[Theta]", ",", " ", "index"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"parameters", ",", " ", 
    RowBox[{"parametric", " ", "space"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sup", "[", "index_", "]"}], ":=", 
   RowBox[{"VarName", "[", 
    RowBox[{"X", ",", " ", "index"}], "]"}]}], " ", 
  RowBox[{"(*", "support", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PP", "[", "index_", "]"}], ":=", 
   RowBox[{"VarName", "[", 
    RowBox[{"pp", ",", " ", "index"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"just", " ", "an", " ", "utility", " ", "variable"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF", "[", "index_", "]"}], ":=", 
   RowBox[{"VarName", "[", 
    RowBox[{"FF", ",", " ", "index"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"just", " ", "an", " ", "utility", " ", "variable"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"L", "[", "index_", "]"}], ":=", 
    RowBox[{"VarName", "[", 
     RowBox[{"L", ",", " ", "index"}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintT", "[", "tensor_", "]"}], ":=", 
  RowBox[{
   RowBox[{"tensor", "//", "TensorComponents"}], "//", 
   "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveAbs", "[", "f_", "]"}], ":=", 
  RowBox[{"ComplexExpand", "[", 
   RowBox[{"Abs", "[", "f", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefaultSimplify", "[", "f_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"f", ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"_", "\[Element]", "PositiveReals"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Universe", "[", "f_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"parameters", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"f", ",", " ", "_Symbol", ",", " ", "\[Infinity]"}], 
             "]"}], "]"}]}], ",", " ", 
          RowBox[{"RegularExpression", "[", "\"\<\[Theta][0-9]+\>\"", "]"}]}],
          "]"}], "]"}]}], ",", " ", 
      RowBox[{"supports", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"f", ",", " ", "_Symbol", ",", " ", "\[Infinity]"}], 
             "]"}], "]"}]}], ",", " ", 
          RowBox[{"RegularExpression", "[", "\"\<X[0-9]+\>\"", "]"}]}], "]"}],
         "]"}]}], ",", " ", 
      RowBox[{"levels", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"f", ",", " ", "_Symbol", ",", " ", "\[Infinity]"}], 
             "]"}], "]"}]}], ",", " ", 
          RowBox[{"RegularExpression", "[", "\"\<L[0-9]+\>\"", "]"}]}], "]"}],
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "/@", "parameters"}], "//", "Sort"}], ",", " ", 
      RowBox[{
       RowBox[{"ToExpression", "/@", "supports"}], "//", "Sort"}], ",", " ", 
      RowBox[{
       RowBox[{"ToExpression", "/@", "levels"}], "//", "Sort"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MetricTensorFromCoordinateVector", "[", "CV_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"UniverseParameters", "=", 
      RowBox[{
       RowBox[{"Universe", "[", "CV", "]"}], "//", "First"}]}], "}"}], ",", 
    " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"CV", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"CV", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "CV", "]"}]}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", " ", 
        RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiagonalEquivalentMatrix", "[", "matrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"matrix", "//", "Eigenvalues"}], "//", 
   "DiagonalMatrix"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HigherDiagonalEquivalentMatrix", "[", "matrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"matrix", "//", "Eigenvalues"}], ",", " ", "0", ",", " ", 
     "Infinity"}], "]"}], "//", "DiagonalMatrix"}]}]}], "Input",
 CellChangeTimes->{{3.904797823989067*^9, 3.9047978242416506`*^9}, {
   3.9048000336368885`*^9, 3.9048000638285093`*^9}, 3.904800103929776*^9, {
   3.904800137011919*^9, 3.904800171556652*^9}, {3.9048004638827605`*^9, 
   3.904800473038624*^9}, {3.90480100826525*^9, 3.9048010464967475`*^9}, {
   3.9048017721693287`*^9, 3.9048017893453283`*^9}, {3.9049860737120104`*^9, 
   3.9049860916749144`*^9}, {3.905222125213209*^9, 3.905222131353882*^9}, {
   3.9052227383908043`*^9, 3.905222781053994*^9}, {3.9052262344623165`*^9, 
   3.9052262420914173`*^9}, {3.9052320443819914`*^9, 
   3.9052320453975687`*^9}, {3.905404553382655*^9, 3.905404635337293*^9}, {
   3.9066256146676893`*^9, 
   3.9066256169342146`*^9}},ExpressionUUID->"17b91fbe-026c-4c21-b67a-\
d11e55068635"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pk", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FF", "[", "i", "]"}], "[", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Par", "[", "j", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
      "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pk", "=", 
   RowBox[{
    RowBox[{"InterpolatingPolynomial", "[", 
     RowBox[{"pk", ",", " ", "x"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UniverseParameters", "=", 
   RowBox[{
    RowBox[{"Universe", "[", "Pk", "]"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "=", 
   RowBox[{"MetricTensorFromCoordinateVector", "[", "pk", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"info", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Pk", ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{"Pk", ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "1", ",", " ", 
          RowBox[{"pk", "//", "Length"}]}], "}"}], ",", " ", 
        RowBox[{"GenerateConditions", "\[Rule]", "False"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", " ", 
        RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Done\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pktilde", "=", 
   RowBox[{
    RowBox[{"Normalize", "[", 
     RowBox[{"pk", ",", " ", "Total"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pktilde", "=", 
   RowBox[{
    RowBox[{"InterpolatingPolynomial", "[", 
     RowBox[{"pktilde", ",", " ", "x"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tildemetric", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"pktilde", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
          RowBox[{"UniverseParameters", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pktilde", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "/", 
         RowBox[{"pktilde", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", " ", "1", ",", " ", 
         RowBox[{"pk", "//", "Length"}]}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", 
       RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tildeinfo", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Pktilde", ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{"Pktilde", ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "1", ",", " ", 
          RowBox[{"pk", "//", "Length"}]}], "}"}], ",", " ", 
        RowBox[{"GenerateConditions", "\[Rule]", "False"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", " ", 
        RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Done\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pkcurly", "=", 
   RowBox[{
    RowBox[{"Pk", "/", 
     RowBox[{"Integrate", "[", 
      RowBox[{"Pk", ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "1", ",", " ", 
         RowBox[{"pk", "//", "Length"}]}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pkcurly", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"Pkcurly", ",", " ", 
        RowBox[{"x", "->", "i"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"pk", "//", "Length"}]}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curlymetric", "=", 
   RowBox[{"MetricTensorFromCoordinateVector", "[", "pkcurly", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curlyinfo", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Pkcurly", ",", " ", 
          RowBox[{"UniverseParameters", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Pkcurly", ",", " ", 
           RowBox[{"UniverseParameters", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "/", "Pkcurly"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "1", ",", " ", 
         RowBox[{"pk", "//", "Length"}]}], "}"}], ",", " ", 
       RowBox[{"GenerateConditions", "\[Rule]", "False"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", 
       RowBox[{"UniverseParameters", "//", "Length"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.904883506040387*^9, 3.9048835240765057`*^9}, {
   3.904883603500243*^9, 3.904883636195542*^9}, {3.9048838027566814`*^9, 
   3.9048839220030003`*^9}, {3.9048839698701477`*^9, 3.904884019495535*^9}, {
   3.904884055826352*^9, 3.904884056061677*^9}, {3.904885375300377*^9, 
   3.904885381300988*^9}, {3.904885473958189*^9, 3.9048854830375595`*^9}, {
   3.9048855442512674`*^9, 3.9048855600433908`*^9}, {3.904886377360656*^9, 
   3.9048864224827123`*^9}, {3.904900777126068*^9, 3.9049007807458816`*^9}, 
   3.904900838342698*^9, {3.904901440113468*^9, 3.9049014554561367`*^9}, {
   3.9049058449862957`*^9, 3.904905855921585*^9}, {3.9049709148835096`*^9, 
   3.904970945207638*^9}, {3.9049710919424047`*^9, 3.904971099959655*^9}, {
   3.9049711613118057`*^9, 3.9049711754836535`*^9}, {3.9049713477062597`*^9, 
   3.9049713497375717`*^9}, {3.9049714143822813`*^9, 
   3.9049714146954365`*^9}, {3.9049715218624053`*^9, 3.904971524581088*^9}, {
   3.904971599643254*^9, 3.904971604440092*^9}, {3.9049716445634775`*^9, 
   3.9049716472354393`*^9}, {3.9049720146158404`*^9, 3.904972021952118*^9}, {
   3.904981689633089*^9, 3.9049817244256897`*^9}, {3.9049820424051065`*^9, 
   3.9049820483546696`*^9}, 3.904982091804863*^9, {3.9049821409595747`*^9, 
   3.904982145371091*^9}, {3.9049822310948515`*^9, 3.9049822339829807`*^9}, {
   3.904982307233364*^9, 3.9049823076526585`*^9}, {3.904982419383174*^9, 
   3.9049824331351175`*^9}, {3.9049824996231375`*^9, 
   3.9049825022031803`*^9}, {3.904982716858573*^9, 3.9049827278595734`*^9}, {
   3.9049829091088233`*^9, 3.9049829118500504`*^9}, {3.9049829454500666`*^9, 
   3.9049829638090153`*^9}, {3.9049830186683025`*^9, 
   3.9049830318917866`*^9}, {3.9049831183285594`*^9, 
   3.9049831672601385`*^9}, {3.9049832711705856`*^9, 3.904983278588807*^9}, {
   3.90498364608017*^9, 3.9049836851986585`*^9}, {3.9049837824389067`*^9, 
   3.904983813170209*^9}, {3.90498384878453*^9, 3.9049838826588974`*^9}, {
   3.9049839877969494`*^9, 3.904984102219446*^9}, {3.9049843064668083`*^9, 
   3.904984314491014*^9}, {3.9049844291584544`*^9, 3.904984432448131*^9}, 
   3.90498447918808*^9, {3.904984740857313*^9, 3.9049847437872114`*^9}, {
   3.9049866639118834`*^9, 3.90498676520667*^9}, {3.904988417463724*^9, 
   3.9049884426982174`*^9}, 3.904988598009313*^9, 3.9049898423310714`*^9, {
   3.9049898909059443`*^9, 3.9049899173457093`*^9}, {3.904989963708612*^9, 
   3.904989993914296*^9}, {3.9049900360228558`*^9, 3.904990083848895*^9}, {
   3.9049903639334116`*^9, 3.9049903814107265`*^9}, {3.9049905060297565`*^9, 
   3.90499053148791*^9}, {3.904990597367841*^9, 3.904990627821477*^9}, {
   3.905217665630289*^9, 3.9052176978639126`*^9}, {3.9052178299603896`*^9, 
   3.905217847952341*^9}, {3.905217879365548*^9, 3.905217919566837*^9}, {
   3.9052179550984216`*^9, 3.9052179834963245`*^9}, {3.905218425001689*^9, 
   3.905218431075451*^9}, {3.9052184732708693`*^9, 3.905218553475806*^9}, {
   3.905219093097243*^9, 3.9052191239956484`*^9}, {3.9052192807940207`*^9, 
   3.9052192814937873`*^9}, {3.905219312752861*^9, 3.9052193178944173`*^9}, {
   3.9052219422893744`*^9, 3.905221965341589*^9}, {3.9052221375261946`*^9, 
   3.905222280866119*^9}, {3.905222349668125*^9, 3.905222350699362*^9}, {
   3.9052224139471865`*^9, 3.9052224909508333`*^9}, {3.9052226119585705`*^9, 
   3.9052226558208914`*^9}, {3.9052228789810677`*^9, 3.905222880910247*^9}, {
   3.9052229469272027`*^9, 3.9052230719742947`*^9}, {3.9052231911995816`*^9, 
   3.905223220531434*^9}, {3.9052233831726284`*^9, 3.9052233834378223`*^9}, {
   3.905223535554934*^9, 3.905223536179906*^9}, {3.9052237347149687`*^9, 
   3.9052237726219935`*^9}, {3.905223811239586*^9, 3.905223811380223*^9}, {
   3.905224157893516*^9, 3.905224265293669*^9}, {3.905224322275964*^9, 
   3.905224322418887*^9}, {3.9052244680035086`*^9, 3.905224468138894*^9}, {
   3.905224959330058*^9, 3.905225003208788*^9}, {3.905225048002892*^9, 
   3.9052250551146784`*^9}, {3.9052251911320477`*^9, 
   3.9052251914640703`*^9}, {3.905225285187154*^9, 3.90522528539128*^9}, {
   3.9052253318661366`*^9, 3.9052253505036016`*^9}, {3.905225466417828*^9, 
   3.9052254665365033`*^9}, {3.9052255218725414`*^9, 3.905225522095538*^9}, {
   3.905226251019558*^9, 3.905226279932381*^9}, {3.9052269331189327`*^9, 
   3.9052269338502054`*^9}, {3.9052316725999346`*^9, 
   3.9052318777907534`*^9}, {3.905231920175112*^9, 3.9052319562212887`*^9}, {
   3.9052320326464663`*^9, 3.9052320734853053`*^9}, {3.9052327390016975`*^9, 
   3.9052327704983015`*^9}, {3.905232875419099*^9, 3.9052328773545218`*^9}, {
   3.905232910802826*^9, 3.90523293805838*^9}, {3.9052330178269997`*^9, 
   3.9052330180090313`*^9}, {3.905403672810862*^9, 3.9054037152330675`*^9}, {
   3.905403745968616*^9, 3.905403894526848*^9}, {3.905403936698614*^9, 
   3.9054040994155436`*^9}, {3.905404140340769*^9, 3.9054041645438757`*^9}, {
   3.9054042142343063`*^9, 3.9054042199845085`*^9}, {3.905404358855465*^9, 
   3.905404390810608*^9}, {3.9054044622536373`*^9, 3.905404486333086*^9}, {
   3.905404538773282*^9, 3.9054045389920316`*^9}, {3.9054046430872917`*^9, 
   3.9054047225783668`*^9}, {3.9054085442013254`*^9, 3.905408576657155*^9}, {
   3.9054086388517294`*^9, 3.9054086620851746`*^9}, {3.905408762659087*^9, 
   3.905408821083205*^9}, {3.9054088560677366`*^9, 3.9054088567781873`*^9}, {
   3.9054096258907986`*^9, 3.9054096265522313`*^9}, {3.9054096999903746`*^9, 
   3.9054098406721973`*^9}, {3.9054098780909395`*^9, 
   3.9054099131123447`*^9}, {3.9054099765830755`*^9, 
   3.9054099772686157`*^9}, {3.9054102629264984`*^9, 
   3.9054102633428555`*^9}, {3.9054108302452283`*^9, 
   3.9054108468200083`*^9}, {3.905410885256035*^9, 3.9054110098906517`*^9}, {
   3.905411084932915*^9, 3.9054111020279055`*^9}, {3.905411146725218*^9, 
   3.9054112907414503`*^9}, {3.9054113590438824`*^9, 
   3.9054114607755146`*^9}, {3.905411505834431*^9, 3.905411506592033*^9}, {
   3.9054115491127253`*^9, 3.905411549558454*^9}, {3.905411598787738*^9, 
   3.90541168822383*^9}, {3.905411720259889*^9, 3.905411723714593*^9}, {
   3.905411843678243*^9, 3.9054118440573316`*^9}, {3.9054118782185106`*^9, 
   3.9054118789511375`*^9}, {3.905411943772959*^9, 3.905411944184789*^9}, {
   3.905411986942549*^9, 3.905411987164627*^9}, {3.9054121150336266`*^9, 
   3.905412210873686*^9}, {3.9054128945178523`*^9, 3.9054131083240347`*^9}, {
   3.9054131904423933`*^9, 3.9054132098637996`*^9}, {3.905413263454856*^9, 
   3.905413263723051*^9}, {3.905415084326602*^9, 3.9054150916199503`*^9}, {
   3.9054202966896825`*^9, 3.905420310477959*^9}, {3.905420343242968*^9, 
   3.9054203516374035`*^9}, {3.9066238927544885`*^9, 3.906624453761303*^9}, {
   3.9066245545081835`*^9, 3.9066245551649036`*^9}, {3.906624620057121*^9, 
   3.9066246807070274`*^9}, {3.9066248475151415`*^9, 3.906624915681922*^9}, {
   3.9066249976185455`*^9, 3.9066250044315605`*^9}, {3.9066251430699778`*^9, 
   3.9066251859713235`*^9}, {3.9066252318958607`*^9, 3.906625269759094*^9}, {
   3.906625338239174*^9, 3.906625347665081*^9}, {3.9066255548639507`*^9, 
   3.906625557207277*^9}, {3.9066256253587756`*^9, 3.9066257757426243`*^9}, {
   3.906626108618545*^9, 3.906626136076353*^9}, {3.906626224708788*^9, 
   3.9066263073333483`*^9}, {3.906626696913481*^9, 3.906626738579382*^9}, {
   3.9066269943299866`*^9, 3.906627022882082*^9}},
 CellLabel->
  "In[1282]:=",ExpressionUUID->"b4335cee-ae25-4489-a6af-2df5b3e1f5ab"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{
  3.9066246826601286`*^9, 3.9066248482505817`*^9, {3.9066248962735634`*^9, 
   3.9066249162600174`*^9}, 3.9066250049471908`*^9, {3.9066251753773756`*^9, 
   3.9066251947216797`*^9}, 3.9066253562640076`*^9, 3.90662556655142*^9, 
   3.9066256898550205`*^9, 3.906625800084694*^9, {3.906626109868102*^9, 
   3.9066261372331257`*^9}, 3.906626276825403*^9, 3.906626312286564*^9, 
   3.9066267480345573`*^9, {3.9066269953297334`*^9, 3.9066270249761877`*^9}},
 CellLabel->
  "During evaluation of \
In[1282]:=",ExpressionUUID->"ddfb907a-ec48-4f57-8807-8ae68ddfc187"],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{
  3.9066246826601286`*^9, 3.9066248482505817`*^9, {3.9066248962735634`*^9, 
   3.9066249162600174`*^9}, 3.9066250049471908`*^9, {3.9066251753773756`*^9, 
   3.9066251947216797`*^9}, 3.9066253562640076`*^9, 3.90662556655142*^9, 
   3.9066256898550205`*^9, 3.906625800084694*^9, {3.906626109868102*^9, 
   3.9066261372331257`*^9}, 3.906626276825403*^9, 3.906626312286564*^9, 
   3.9066267480345573`*^9, 3.9066269953297334`*^9, 3.906627031601879*^9},
 CellLabel->
  "During evaluation of \
In[1282]:=",ExpressionUUID->"95591959-9c86-4da2-97db-14b8b1e40cb5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"info", "//", "Det"}], "//", "FullSimplify"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"metric", "//", "Det"}], "//", "FullSimplify"}], ")"}]}], ")"}],
   "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"tildeinfo", "//", "HigherDiagonalEquivalentMatrix"}], "//", 
       "Det"}], "//", "FullSimplify"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"tildemetric", "//", "HigherDiagonalEquivalentMatrix"}], "//", 
       "Det"}], "//", "FullSimplify"}], ")"}]}], ")"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"curlyinfo", "//", "HigherDiagonalEquivalentMatrix"}], "//", 
       "Det"}], "//", "FullSimplify"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"curlymetric", "//", "HigherDiagonalEquivalentMatrix"}], "//", 
       "Det"}], "//", "FullSimplify"}], ")"}]}], ")"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.9066244665010595`*^9, 3.906624535911425*^9}, {
  3.9066249291833544`*^9, 3.906624946566531*^9}, {3.9066255028384776`*^9, 
  3.906625511359054*^9}},
 CellLabel->
  "In[1279]:=",ExpressionUUID->"8104c8e2-172c-4f97-8c84-aec1357506cf"],

Cell[BoxData[
 FractionBox["1", "12"]], "Output",
 CellChangeTimes->{{3.9066244709716616`*^9, 3.906624475773472*^9}, 
   3.9066245368489285`*^9, {3.9066249223073397`*^9, 3.9066249472848263`*^9}, 
   3.906625016495693*^9, 3.9066252783152094`*^9, 3.90662542788247*^9, 
   3.9066255126871996`*^9, 3.906625995642789*^9, {3.9066261188216953`*^9, 
   3.9066261275582833`*^9}, 3.9066261654254203`*^9, 3.9066264756632366`*^9, 
   3.906626901980151*^9, 3.9066269439822717`*^9, 3.906627004096981*^9},
 CellLabel->
  "Out[1279]=",ExpressionUUID->"e26fec53-4a06-4454-ac6d-6224ab9d6dfb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"FF1", "[", 
    RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], " ", 
   RowBox[{"FF2", "[", 
    RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}]}], 
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FF1", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], "+", 
      RowBox[{"FF2", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{{3.9066244709716616`*^9, 3.906624475773472*^9}, 
   3.9066245368489285`*^9, {3.9066249223073397`*^9, 3.9066249472848263`*^9}, 
   3.906625016495693*^9, 3.9066252783152094`*^9, 3.90662542788247*^9, 
   3.9066255126871996`*^9, 3.906625995642789*^9, {3.9066261188216953`*^9, 
   3.9066261275582833`*^9}, 3.9066261654254203`*^9, 3.9066264756632366`*^9, 
   3.906626901980151*^9, 3.9066269439822717`*^9, 3.9066270041907206`*^9},
 CellLabel->
  "Out[1280]=",ExpressionUUID->"95e31408-ca0b-4448-8703-bd37d04d47fd"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FF1", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], "+", 
      RowBox[{"FF2", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"FF1", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"FF1", "[", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"FF2", "[", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], "]"}]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"FF2", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"Log", "[", 
         RowBox[{"FF1", "[", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"FF2", "[", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], "]"}]}], ")"}]}]}], 
    ")"}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FF1", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}], "-", 
      RowBox[{"FF2", "[", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "]"}]}], ")"}], 
    "3"]}]]], "Output",
 CellChangeTimes->{{3.9066244709716616`*^9, 3.906624475773472*^9}, 
   3.9066245368489285`*^9, {3.9066249223073397`*^9, 3.9066249472848263`*^9}, 
   3.906625016495693*^9, 3.9066252783152094`*^9, 3.90662542788247*^9, 
   3.9066255126871996`*^9, 3.906625995642789*^9, {3.9066261188216953`*^9, 
   3.9066261275582833`*^9}, 3.9066261654254203`*^9, 3.9066264756632366`*^9, 
   3.906626901980151*^9, 3.9066269439822717`*^9, 3.906627004409481*^9},
 CellLabel->
  "Out[1281]=",ExpressionUUID->"752327db-20a7-4e07-b810-c062d2d605bf"]
}, Open  ]]
},
WindowSize->{1152., 579.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
Magnification:>0.8 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1641f95f-fb88-4859-8d78-5a8167fb6c5e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7120, 183, 350, "Input",ExpressionUUID->"17b91fbe-026c-4c21-b67a-d11e55068635"],
Cell[CellGroupData[{
Cell[7703, 207, 14373, 295, 388, "Input",ExpressionUUID->"b4335cee-ae25-4489-a6af-2df5b3e1f5ab"],
Cell[CellGroupData[{
Cell[22101, 506, 617, 10, 18, "Print",ExpressionUUID->"ddfb907a-ec48-4f57-8807-8ae68ddfc187"],
Cell[22721, 518, 613, 10, 18, "Print",ExpressionUUID->"95591959-9c86-4da2-97db-14b8b1e40cb5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23383, 534, 1457, 43, 54, "Input",ExpressionUUID->"8104c8e2-172c-4f97-8c84-aec1357506cf"],
Cell[24843, 579, 574, 9, 40, "Output",ExpressionUUID->"e26fec53-4a06-4454-ac6d-6224ab9d6dfb"],
Cell[25420, 590, 1002, 23, 43, "Output",ExpressionUUID->"95e31408-ca0b-4448-8703-bd37d04d47fd"],
Cell[26425, 615, 1990, 53, 45, "Output",ExpressionUUID->"752327db-20a7-4e07-b810-c062d2d605bf"]
}, Open  ]]
}
]
*)

