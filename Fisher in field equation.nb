(* Content-type: application/vnd.wolfram.cdf.text *)

(*** Wolfram CDF File ***)
(* http://www.wolfram.com/cdf *)

(* CreatedBy='Mathematica 13.0' *)

(***************************************************************************)
(*                                                                         *)
(*                                                                         *)
(*  Under the Wolfram FreeCDF terms of use, this file and its content are  *)
(*  bound by the Creative Commons BY-SA Attribution-ShareAlike license.    *)
(*                                                                         *)
(*        For additional information concerning CDF licensing, see:        *)
(*                                                                         *)
(*         www.wolfram.com/cdf/adopting-cdf/licensing-options.html         *)
(*                                                                         *)
(*                                                                         *)
(***************************************************************************)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[      1088,         20]
NotebookDataLength[     45390,        977]
NotebookOptionsPosition[     45440,        970]
NotebookOutlinePosition[     45874,        987]
CellTagsIndexPosition[     45831,        984]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<DarkMode\>\"", "]"}], "[", "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<TensoriaCalc.m\>\""}], "//", 
  "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VarName", "[", 
   RowBox[{"var_", ",", " ", "index_"}], "]"}], ":=", 
  RowBox[{"ToExpression", "[", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"ToString", "[", "var", "]"}], ",", " ", 
     RowBox[{"ToString", "[", "index", "]"}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Par", "[", "index_", "]"}], ":=", 
   RowBox[{"VarName", "[", 
    RowBox[{"\[Theta]", ",", " ", "index"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"parameters", ",", " ", 
    RowBox[{"parametric", " ", "space"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sup", "[", "index_", "]"}], ":=", 
   RowBox[{"VarName", "[", 
    RowBox[{"X", ",", " ", "index"}], "]"}]}], " ", 
  RowBox[{"(*", "support", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PP", "[", "index_", "]"}], ":=", 
   RowBox[{"VarName", "[", 
    RowBox[{"pp", ",", " ", "index"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"just", " ", "an", " ", "utility", " ", "variable"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"L", "[", "index_", "]"}], ":=", 
    RowBox[{"VarName", "[", 
     RowBox[{"L", ",", " ", "index"}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintT", "[", "tensor_", "]"}], ":=", 
  RowBox[{
   RowBox[{"tensor", "//", "TensorComponents"}], "//", 
   "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveAbs", "[", "f_", "]"}], ":=", 
  RowBox[{"ComplexExpand", "[", 
   RowBox[{"Abs", "[", "f", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefaultSimplify", "[", "f_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"f", ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"_", "\[Element]", "PositiveReals"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Abs", ",", " ", "Arg"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Abs", "[", "x_", "]"}], ":=", "x"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Arg", "[", "x_", "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protected", "[", 
    RowBox[{"Abs", ",", " ", "Arg"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Universe", "[", "f_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"parameters", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"StringCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"f", ",", " ", "_Symbol", ",", " ", "\[Infinity]"}], 
              "]"}], "]"}]}], ",", " ", 
           RowBox[{
           "RegularExpression", "[", "\"\<\[Theta][0-9]+\>\"", "]"}]}], "]"}],
          "]"}]}], ",", " ", 
       RowBox[{"supports", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"StringCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"f", ",", " ", "_Symbol", ",", " ", "\[Infinity]"}], 
              "]"}], "]"}]}], ",", " ", 
           RowBox[{"RegularExpression", "[", "\"\<X[0-9]+\>\"", "]"}]}], 
          "]"}], "]"}]}], ",", " ", 
       RowBox[{"levels", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"StringCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"f", ",", " ", "_Symbol", ",", " ", "\[Infinity]"}], 
              "]"}], "]"}]}], ",", " ", 
           RowBox[{"RegularExpression", "[", "\"\<L[0-9]+\>\"", "]"}]}], 
          "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "parameters", "]"}], ",", " ", 
       RowBox[{"Length", "[", "supports", "]"}], ",", " ", 
       RowBox[{"Length", "[", "levels", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"derivativeProduct", "[", 
   RowBox[{"f_", ",", " ", "coordinates_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"Par", "[", "i", "]"}]}], "]"}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"Par", "[", "j", "]"}]}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", "coordinates"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"j", ",", " ", "1", ",", " ", "coordinates"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gMetric", "[", "p_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"spacesize", "=", 
       RowBox[{"Length", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"coordinates", "=", 
       RowBox[{
        RowBox[{"Universe", "[", "p", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"derivativeProduct", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", " ", "coordinates"}], "]"}], 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"k", ",", " ", "1", ",", " ", "spacesize"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FIT", "[", "p_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"spacesize", "=", 
       RowBox[{"Length", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"coordinates", "=", 
       RowBox[{
        RowBox[{"Universe", "[", "p", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"derivativeProduct", "[", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", " ", "coordinates"}], "]"}], 
       "/", 
       RowBox[{"p", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"k", ",", " ", "1", ",", " ", "spacesize"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "[", "p_", "]"}], ":=", 
  RowBox[{"1", "/", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"1", "/", "4"}], " ", 
     RowBox[{"p", "^", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FITgMetric", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"derivativeProduct", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "p", "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Universe", "[", "p", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "/", 
    RowBox[{
     RowBox[{"\[Mu]", "[", "p", "]"}], "^", "2"}]}], "+", 
   RowBox[{
    RowBox[{"\[Mu]", "[", "p", "]"}], 
    RowBox[{"gMetric", "[", "p", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MinorFITgMetric", "[", "p_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eigen", "=", 
      RowBox[{
       RowBox[{"FITgMetric", "[", "p", "]"}], "//", "Eigenvalues"}]}], "}"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"eigen", ",", " ", "0"}], "]"}], "//", "DiagonalMatrix"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JacobianMatrix", "[", "p_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"spacesize", "=", 
       RowBox[{"Length", "[", "p", "]"}]}], ",", 
      RowBox[{"coordinates", "=", 
       RowBox[{
        RowBox[{"Universe", "[", "p", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
        RowBox[{"Par", "[", "j", "]"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", "spacesize"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", " ", "coordinates"}], "}"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.533853660737237*^9, 3.5338536613372374`*^9}, {
   3.533854260450047*^9, 3.533854455863923*^9}, {3.5338545231682177`*^9, 
   3.5338545442828474`*^9}, {3.5338545850629044`*^9, 
   3.5338546140899453`*^9}, {3.533854656783005*^9, 3.533855114760253*^9}, {
   3.5338552409958315`*^9, 3.5338556389015937`*^9}, {3.533855739520935*^9, 
   3.5338559026003647`*^9}, {3.533856124081277*^9, 3.533856132538489*^9}, 
   3.5338567495509577`*^9, {3.5339320859790726`*^9, 3.533932086665474*^9}, {
   3.533932121079134*^9, 3.533932121313134*^9}, {3.5391927530277014`*^9, 
   3.5391927705141263`*^9}, {3.5391935206364193`*^9, 
   3.5391938766914454`*^9}, {3.8872839395900345`*^9, 
   3.8872839427150745`*^9}, {3.8872840307859488`*^9, 3.887284054911822*^9}, 
   3.887284100822419*^9, {3.8872841422638235`*^9, 3.887284265837549*^9}, {
   3.8872843169124727`*^9, 3.887284327554427*^9}, {3.8872843919773393`*^9, 
   3.8872844166475887`*^9}, {3.8872844790036077`*^9, 
   3.8872844793942127`*^9}, {3.8872876777779408`*^9, 3.887287679544649*^9}, {
   3.8902366148180346`*^9, 3.8902366181301327`*^9}, {3.890238556561818*^9, 
   3.890238556874735*^9}, 3.8902386674245424`*^9, {3.890240364044637*^9, 
   3.890240411724372*^9}, {3.8902418809068375`*^9, 3.8902418826259913`*^9}, {
   3.8902420272969236`*^9, 3.890242027937547*^9}, {3.8905020937413583`*^9, 
   3.8905020941007004`*^9}, {3.8905034014477386`*^9, 
   3.8905034022916346`*^9}, {3.8905041741198883`*^9, 
   3.8905041751515417`*^9}, {3.8905042575609255`*^9, 3.890504275375786*^9}, {
   3.8905044169605875`*^9, 3.890504423132458*^9}, {3.890885487686494*^9, 
   3.890885500812374*^9}, {3.890885532701808*^9, 3.8908855390246253`*^9}, {
   3.8908856089023557`*^9, 3.8908856613215656`*^9}, {3.8908864591894827`*^9, 
   3.8908864964338007`*^9}, {3.8908875559845*^9, 3.890887578909176*^9}, {
   3.890887629061304*^9, 3.8908876305732703`*^9}, {3.8908880128926425`*^9, 
   3.8908880245647297`*^9}, {3.89088806496559*^9, 3.8908882259903126`*^9}, {
   3.89088825811429*^9, 3.8908883492404013`*^9}, {3.8908884330794816`*^9, 
   3.8908884938107195`*^9}, {3.8908885336727896`*^9, 3.890888534394178*^9}, {
   3.890891222377161*^9, 3.890891246960611*^9}, {3.8909020411723347`*^9, 
   3.8909020539978065`*^9}, {3.8909023590870647`*^9, 3.89090237097731*^9}, {
   3.8909028576441755`*^9, 3.8909028588316126`*^9}, {3.8909029644937167`*^9, 
   3.8909029646652193`*^9}, {3.8909030658332405`*^9, 3.890903120319295*^9}, {
   3.89090390542655*^9, 3.890903945693159*^9}, {3.890904001518943*^9, 
   3.8909040058314404`*^9}, {3.890904310913518*^9, 3.890904311069775*^9}, {
   3.8909043528979297`*^9, 3.8909043646959925`*^9}, {3.89092593753304*^9, 
   3.8909260196537952`*^9}, {3.890926353115323*^9, 3.8909263717414722`*^9}, {
   3.8909272996482472`*^9, 3.890927302244661*^9}, {3.890927458763691*^9, 
   3.8909274640109434`*^9}, {3.8909275354964266`*^9, 3.890927562591723*^9}, {
   3.8909276220108843`*^9, 3.890927625031666*^9}, {3.89092769465073*^9, 
   3.8909277013356104`*^9}, {3.8909288185840178`*^9, 3.890928825273039*^9}, {
   3.8909919067320976`*^9, 3.8909919069520397`*^9}, {3.89099203444788*^9, 
   3.8909920436868267`*^9}, {3.890992244433977*^9, 3.890992251819831*^9}, {
   3.8909936942491636`*^9, 3.890993694374792*^9}, {3.891008945182377*^9, 
   3.891008959982954*^9}, {3.8910111629711633`*^9, 3.8910112664754505`*^9}, {
   3.8910552126106615`*^9, 3.89105535677446*^9}, {3.8910554400924435`*^9, 
   3.8910554475510035`*^9}, {3.891055512723788*^9, 3.8910555191147137`*^9}, {
   3.891056380053904*^9, 3.891056394579915*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0939406d-c35b-479f-9024-0b74488d8234"],

Cell[BoxData[{
 RowBox[{"p", "=", 
  RowBox[{"CoordinateTransform", "[", 
   RowBox[{
    RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Par", "[", "1", "]"}], ",", " ", 
      RowBox[{"Par", "[", "2", "]"}], ",", " ", 
      RowBox[{"Par", "[", "3", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JacobianMatrix", "[", "p", "]"}], "//", "DefaultSimplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gMetric", "[", "p", "]"}], "//", "DefaultSimplify"}], "//", 
    "Eigenvalues"}], "//", "DiagonalMatrix"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FITgMetric", "[", "p", "]"}], "//", "DefaultSimplify"}], "//", 
    "Eigenvalues"}], "//", "DiagonalMatrix"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MinorFITgMetric", "[", "p", "]"}], "//", "DefaultSimplify"}], "//",
     "Eigenvalues"}], "//", "DiagonalMatrix"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Det"}], "//", "DefaultSimplify"}]}], "Input",
 CellChangeTimes->{{3.889108763381042*^9, 3.8891088683640676`*^9}, {
   3.8891089043083487`*^9, 3.8891090750128703`*^9}, 3.8891091429378057`*^9, {
   3.889109175280604*^9, 3.8891091946162157`*^9}, {3.8891092578420105`*^9, 
   3.8891092588656206`*^9}, {3.8891092959728084`*^9, 3.889109368401062*^9}, {
   3.8891093995558777`*^9, 3.889109454438493*^9}, {3.889109551976242*^9, 
   3.8891095593375435`*^9}, {3.889109738482519*^9, 3.8891097603092985`*^9}, {
   3.889109865805502*^9, 3.889109902971594*^9}, {3.88910993317596*^9, 
   3.8891099888513727`*^9}, {3.88911003607685*^9, 3.8891100596934624`*^9}, {
   3.8891105462103205`*^9, 3.889110587161485*^9}, {3.8891106186027718`*^9, 
   3.8891106552544947`*^9}, {3.8891107132211914`*^9, 
   3.8891107347578993`*^9}, {3.889110928923665*^9, 3.8891109995255985`*^9}, {
   3.889111054756102*^9, 3.8891111478929343`*^9}, {3.8891112679705915`*^9, 
   3.8891114126071205`*^9}, {3.889111499318339*^9, 3.8891115091772585`*^9}, {
   3.8891116438059626`*^9, 3.889111712630047*^9}, {3.889431670710837*^9, 
   3.8894317106723423`*^9}, {3.8894317478806176`*^9, 3.8894317489278326`*^9}, 
   3.8894318094897337`*^9, {3.8894318907164917`*^9, 3.8894319394122896`*^9}, {
   3.8894319780411277`*^9, 3.8894319979953465`*^9}, {3.889432037262702*^9, 
   3.8894320654658127`*^9}, {3.889432164940798*^9, 3.889432207148532*^9}, 
   3.8894322714830275`*^9, {3.889432469076096*^9, 3.8894324702948494`*^9}, {
   3.8894326528030114`*^9, 3.889432656333974*^9}, {3.889432688449854*^9, 
   3.8894327274866323`*^9}, {3.8894327751931286`*^9, 
   3.8894328063903437`*^9}, {3.889432848651111*^9, 3.8894329025254893`*^9}, {
   3.8894329513734426`*^9, 3.8894329829222364`*^9}, {3.889433049055835*^9, 
   3.8894331584504986`*^9}, {3.8894332057958484`*^9, 3.889433371313547*^9}, {
   3.8894334115864487`*^9, 3.889433447514845*^9}, {3.8894334850828686`*^9, 
   3.889433486035555*^9}, {3.8895403733232393`*^9, 3.8895403744584293`*^9}, {
   3.8895404180044436`*^9, 3.8895404216764364`*^9}, 3.889541203288053*^9, 
   3.8895420374989367`*^9, {3.8905034453098087`*^9, 3.8905034767794437`*^9}, {
   3.8905035664990377`*^9, 3.8905036497826147`*^9}, {3.8905036872906833`*^9, 
   3.890503730419116*^9}, {3.8905037823880434`*^9, 3.890503819594978*^9}, {
   3.8905038601423817`*^9, 3.8905038676712213`*^9}, {3.890503991735715*^9, 
   3.8905040185651608`*^9}, {3.89050440334655*^9, 3.890504413991825*^9}, {
   3.890504449583165*^9, 3.8905044561014886`*^9}, {3.890504521924249*^9, 
   3.8905045223620257`*^9}, {3.890504553425768*^9, 3.8905045535660667`*^9}, {
   3.890504584920004*^9, 3.8905045869516077`*^9}, {3.8908875408721*^9, 
   3.890887547575385*^9}, {3.890887702919021*^9, 3.8908877067989798`*^9}, {
   3.890887758862692*^9, 3.8908877645061617`*^9}, {3.890887807890871*^9, 
   3.890887866689633*^9}, {3.8908879315961065`*^9, 3.890887968030051*^9}, {
   3.8908883641633525`*^9, 3.8908884177216883`*^9}, {3.890888517459987*^9, 
   3.890888740435898*^9}, {3.8909255191031113`*^9, 3.890925538060505*^9}, {
   3.890925583483186*^9, 3.890925653776298*^9}, 3.890925756819877*^9, {
   3.8909259206809373`*^9, 3.8909259339013925`*^9}, {3.8909260267120476`*^9, 
   3.8909260335205975`*^9}, {3.890926066435399*^9, 3.890926075527731*^9}, {
   3.8909261218323994`*^9, 3.8909261263799067`*^9}, {3.890926171781089*^9, 
   3.8909261742624474`*^9}, {3.8909270267837467`*^9, 
   3.8909270623898063`*^9}, {3.8909271886941204`*^9, 
   3.8909271895712214`*^9}, {3.890927484559415*^9, 3.8909275153318157`*^9}, {
   3.8909275661364307`*^9, 3.8909275960308466`*^9}, {3.890927669445722*^9, 
   3.890927675633238*^9}, {3.8909288402109127`*^9, 3.890928861309716*^9}, {
   3.8909289417246656`*^9, 3.890928945087449*^9}, {3.890929004028653*^9, 
   3.890929007426107*^9}, {3.890929064312517*^9, 3.8909291131924334`*^9}, {
   3.8909291510629487`*^9, 3.890929198496646*^9}, {3.890929410879318*^9, 
   3.890929415464901*^9}, {3.8909900254759736`*^9, 3.890990059259201*^9}, {
   3.890991810265321*^9, 3.890991867680207*^9}, {3.890992120764065*^9, 
   3.8909921217264924`*^9}, {3.8909922562088423`*^9, 3.890992259519092*^9}, {
   3.8909925729845057`*^9, 3.890992574364438*^9}, {3.8909926599746847`*^9, 
   3.890992671871072*^9}, {3.8909931451977477`*^9, 3.8909931505209017`*^9}, {
   3.890993382662848*^9, 3.8909934296483097`*^9}, {3.890993506328388*^9, 
   3.8909935113218155`*^9}, {3.890993544423798*^9, 3.8909935555886927`*^9}, {
   3.8909939411914964`*^9, 3.890993945865553*^9}, {3.890994487964958*^9, 
   3.89099449459625*^9}, {3.8909946677337523`*^9, 3.8909946722741804`*^9}, {
   3.8909949136128187`*^9, 3.8909949887430944`*^9}, {3.890995022171177*^9, 
   3.890995124136304*^9}, {3.8909951589012337`*^9, 3.8909952026811233`*^9}, {
   3.890995986091658*^9, 3.8909960727576466`*^9}, {3.890996119833043*^9, 
   3.890996121193169*^9}, {3.890996331211178*^9, 3.8909963716130524`*^9}, {
   3.890996426446293*^9, 3.8909964383621235`*^9}, {3.890996470500163*^9, 
   3.8909964832817984`*^9}, {3.89099704288809*^9, 3.8909970497930374`*^9}, {
   3.890997288732061*^9, 3.8909972961518803`*^9}, {3.8909973609942083`*^9, 
   3.890997368663473*^9}, {3.8909982182126293`*^9, 3.890998222352725*^9}, {
   3.8909987346575565`*^9, 3.8909987571761446`*^9}, {3.8909988275905743`*^9, 
   3.8909988714219894`*^9}, {3.891000788046782*^9, 3.8910008157734003`*^9}, {
   3.8910087520408764`*^9, 3.891008754736951*^9}, {3.891009171664049*^9, 
   3.891009176165038*^9}, {3.891009795036949*^9, 3.891009811020011*^9}, {
   3.8910098438803205`*^9, 3.891009845122306*^9}, {3.8910099403956656`*^9, 
   3.891009949751197*^9}, {3.891012809479644*^9, 3.891012837622216*^9}, {
   3.891012886672268*^9, 3.891012924626191*^9}, {3.8910129556360245`*^9, 
   3.8910129824157963`*^9}, {3.891013334735211*^9, 3.8910133504364433`*^9}, {
   3.8910552308809223`*^9, 3.891055240538492*^9}, {3.8911422559010563`*^9, 
   3.89114226372967*^9}, {3.891142333303155*^9, 3.8911423334440827`*^9}, {
   3.8911425788563952`*^9, 3.891142589170438*^9}, {3.8911428426334248`*^9, 
   3.891142842758705*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"c3afc09d-11cd-4097-ac54-a97d849b5ac2"],

Cell[BoxData[{
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", 
       SuperscriptBox["\[Theta]1", "2"], "0"},
      {"0", "0", 
       RowBox[{
        SuperscriptBox["\[Theta]1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CholeskyDecomposition", "[", "%%", "]"}], "//", 
   "DefaultSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "Eigenvalues"}], "//", "DefaultSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"newp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"%", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
        RowBox[{"Par", "[", "i", "]"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", "%", "]"}]}], "}"}]}], "]"}], "//", 
    "ComplexExpand"}], "//", "DefaultSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JacobianMatrix", "[", 
     RowBox[{"2", " ", 
      RowBox[{"newp", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Total", "[", 
         RowBox[{"newp", "^", "2"}], "]"}], "]"}]}]}], "]"}], "//", 
    "DefaultSimplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"gMetric", "[", "newp", "]"}], "//", "DefaultSimplify"}], "//", 
     "MatrixForm"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"gMetric", "[", 
       RowBox[{"newp", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Total", "[", 
          RowBox[{"newp", "^", "2"}], "]"}], "]"}]}], "]"}]}], "//", 
     "DefaultSimplify"}], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FITgMetric", "[", "newp", "]"}], "//", "DefaultSimplify"}], "//",
    "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinorFITgMetric", "[", "newp", "]"}], "//", "Det"}], "//", 
  "DefaultSimplify"}]}], "Input",
 CellChangeTimes->{{3.889540460507044*^9, 3.889540535420151*^9}, {
   3.889540616957665*^9, 3.8895406337974353`*^9}, {3.8895406785393887`*^9, 
   3.8895407020225143`*^9}, {3.8895407466336737`*^9, 3.889540748452859*^9}, {
   3.8895408925857325`*^9, 3.8895409299308767`*^9}, {3.8895412189321856`*^9, 
   3.8895412284028864`*^9}, {3.8895412602069454`*^9, 
   3.8895413336956763`*^9}, {3.8895415896607995`*^9, 
   3.8895415899289727`*^9}, {3.8895419331254153`*^9, 
   3.8895419523608484`*^9}, {3.889542271243593*^9, 3.889542273932071*^9}, {
   3.889581349509979*^9, 3.889581349920159*^9}, {3.889583909273425*^9, 
   3.889583933681795*^9}, {3.889583964449129*^9, 3.8895840192033834`*^9}, {
   3.8902366910977*^9, 3.8902367981989193`*^9}, {3.8902369674464064`*^9, 
   3.890237025247509*^9}, 3.890237170337528*^9, {3.8902380196159043`*^9, 
   3.890238039944026*^9}, {3.890238075977248*^9, 3.890238172642374*^9}, {
   3.8902382087550144`*^9, 3.8902382156147947`*^9}, {3.8902382472112646`*^9, 
   3.8902382484612637`*^9}, {3.890238305544237*^9, 3.8902383618277445`*^9}, {
   3.890238392738595*^9, 3.8902385205289855`*^9}, {3.8902385749342527`*^9, 
   3.8902386385213757`*^9}, {3.890238714387879*^9, 3.890238737829283*^9}, {
   3.890238772127654*^9, 3.8902387762681985`*^9}, {3.8902389237523365`*^9, 
   3.890238955396405*^9}, {3.890238986984514*^9, 3.890239017535821*^9}, {
   3.8902391287263865`*^9, 3.890239132452148*^9}, {3.890239190559144*^9, 
   3.8902391923720903`*^9}, {3.890239245845989*^9, 3.890239256334052*^9}, {
   3.890239293244282*^9, 3.890239346921931*^9}, {3.890239403625944*^9, 
   3.8902394044853153`*^9}, {3.89023943730103*^9, 3.890239437644806*^9}, {
   3.890239598538893*^9, 3.890239634618945*^9}, {3.890239691998374*^9, 
   3.8902397303972273`*^9}, {3.890239818754574*^9, 3.8902398497277308`*^9}, 
   3.890239888238175*^9, {3.8902399860928516`*^9, 3.8902400282576017`*^9}, {
   3.89024007082365*^9, 3.8902401020858183`*^9}, {3.890240136390072*^9, 
   3.890240207662776*^9}, {3.8902402912560463`*^9, 3.8902403450898266`*^9}, {
   3.8902404356373777`*^9, 3.890240558428553*^9}, {3.890240594465101*^9, 
   3.8902405964967628`*^9}, {3.8902406271701884`*^9, 3.890240638499833*^9}, {
   3.8902408167699575`*^9, 3.8902408685352983`*^9}, {3.890240954591735*^9, 
   3.890241025132547*^9}, {3.8902411259673996`*^9, 3.8902411261861577`*^9}, {
   3.8902411932916756`*^9, 3.890241227347796*^9}, {3.8902414078547564`*^9, 
   3.8902414515667543`*^9}, {3.8902415161526194`*^9, 3.890241720850608*^9}, {
   3.890241779464713*^9, 3.8902418028415065`*^9}, {3.890241859062065*^9, 
   3.89024192791029*^9}, {3.8902420083092785`*^9, 3.8902420219521894`*^9}, {
   3.890503405338318*^9, 3.8905034304346113`*^9}, 3.8905036138757057`*^9, {
   3.890504028099723*^9, 3.8905040871677613`*^9}, {3.890504126793167*^9, 
   3.890504141872151*^9}, {3.890504201480903*^9, 3.8905042441237335`*^9}, {
   3.890504291206255*^9, 3.8905042932843494`*^9}, {3.8908890637178*^9, 
   3.890889294002346*^9}, {3.8908895354971323`*^9, 3.8908895607604017`*^9}, {
   3.890889629906185*^9, 3.890889661343507*^9}, {3.890889692199031*^9, 
   3.890889736058282*^9}, {3.8908897741378846`*^9, 3.890889837568111*^9}, {
   3.8908898815711274`*^9, 3.8908898960628157`*^9}, {3.8908900023540125`*^9, 
   3.8908900176460533`*^9}, {3.8908900996203947`*^9, 3.890890159945447*^9}, {
   3.8908902520825276`*^9, 3.890890266363757*^9}, {3.8908903314290323`*^9, 
   3.8908903972121277`*^9}, {3.890890476005748*^9, 3.8908905058727837`*^9}, {
   3.890890940107176*^9, 3.8908910098645916`*^9}, {3.890891399369198*^9, 
   3.8908914066698604`*^9}, {3.890891441047697*^9, 3.8908915280644836`*^9}, {
   3.890891576481282*^9, 3.8908916155440445`*^9}, {3.8909020953378105`*^9, 
   3.890902172195238*^9}, {3.890902298334177*^9, 3.8909023032106333`*^9}, {
   3.8909025495325665`*^9, 3.890902646364009*^9}, {3.890902792531454*^9, 
   3.890902793906831*^9}, {3.8909028415961094`*^9, 3.890902846269543*^9}, {
   3.890902880208041*^9, 3.890902946274517*^9}, 3.890902981823413*^9, {
   3.890903154430293*^9, 3.890903208274461*^9}, {3.890903329777577*^9, 
   3.8909033421082416`*^9}, {3.8909034757845945`*^9, 
   3.8909035119991703`*^9}, {3.8909035451490297`*^9, 
   3.8909035453209443`*^9}, {3.890904123871978*^9, 3.890904280380877*^9}, {
   3.8909239856173754`*^9, 3.8909240181999493`*^9}, {3.89092411317604*^9, 
   3.8909241529090962`*^9}, {3.8909242412820015`*^9, 
   3.8909242807926893`*^9}, {3.890924312570243*^9, 3.8909243144266596`*^9}, {
   3.890924359573179*^9, 3.890924361937559*^9}, {3.8909248380880284`*^9, 
   3.890924841852751*^9}, {3.8909248873133373`*^9, 3.8909249231725874`*^9}, {
   3.8909249539543734`*^9, 3.890924979942793*^9}, {3.890925047669611*^9, 
   3.8909250640266647`*^9}, {3.8909254435979843`*^9, 3.890925451144023*^9}, {
   3.8909256760294876`*^9, 3.8909257354541607`*^9}, {3.8909259097141795`*^9, 
   3.890925911098604*^9}, {3.890926040476324*^9, 3.8909260514890003`*^9}, {
   3.89092643919214*^9, 3.890926439805029*^9}, {3.8909268991676755`*^9, 
   3.89092689966261*^9}, {3.8909280229629593`*^9, 3.8909280311437745`*^9}, {
   3.890928080345812*^9, 3.890928115044878*^9}, {3.89092931640948*^9, 
   3.89092931683377*^9}, {3.890929450401348*^9, 3.8909294508413234`*^9}, {
   3.8909294983711414`*^9, 3.8909294999069157`*^9}, {3.8909295411456966`*^9, 
   3.8909295433912773`*^9}, {3.8909296367120333`*^9, 3.890929640352219*^9}, {
   3.890929924401605*^9, 3.8909299248239737`*^9}, {3.8909299706837134`*^9, 
   3.890929970981254*^9}, {3.890930008071293*^9, 3.890930046651277*^9}, {
   3.8909302372167873`*^9, 3.890930277396119*^9}, {3.8909303207381425`*^9, 
   3.890930322433571*^9}, {3.890930354377517*^9, 3.8909303588251524`*^9}, {
   3.890930527353507*^9, 3.890930528874446*^9}, {3.8909308710598783`*^9, 
   3.8909310727720556`*^9}, {3.8909311070957713`*^9, 
   3.8909312561814423`*^9}, {3.8909313148092213`*^9, 
   3.8909313379272213`*^9}, {3.8909314604473963`*^9, 
   3.8909314692630215`*^9}, {3.8909894720199423`*^9, 3.89098947232084*^9}, {
   3.890989562838424*^9, 3.8909895891397653`*^9}, {3.890989630577304*^9, 
   3.8909896447414193`*^9}, {3.8909899356569567`*^9, 3.890989937194168*^9}, {
   3.8909899774093604`*^9, 3.8909900049124737`*^9}, {3.890990485091164*^9, 
   3.8909905043701954`*^9}, {3.890990542774506*^9, 3.8909905660776186`*^9}, {
   3.890991037414692*^9, 3.890991059919943*^9}, 3.8909911089306216`*^9, {
   3.8909914231114817`*^9, 3.890991449189089*^9}, {3.8909914839552794`*^9, 
   3.8909916037579346`*^9}, {3.8909917592717404`*^9, 
   3.8909917941748066`*^9}, {3.8909918844145155`*^9, 
   3.8909918971656437`*^9}, {3.8909919475085692`*^9, 
   3.8909920149964933`*^9}, {3.890992078880313*^9, 3.890992100020471*^9}, {
   3.890992147923582*^9, 3.8909921601056356`*^9}, {3.890992272577424*^9, 
   3.890992275012592*^9}, {3.8909925886630073`*^9, 3.8909925996792173`*^9}, {
   3.890992736728422*^9, 3.8909927969087763`*^9}, {3.890992848284967*^9, 
   3.890992852018538*^9}, {3.8909931628936853`*^9, 3.8909932089749117`*^9}, {
   3.8909932545210285`*^9, 3.8909933571442995`*^9}, {3.8909934538166695`*^9, 
   3.8909934610428824`*^9}, {3.890993563715136*^9, 3.8909935639826565`*^9}, {
   3.89099384543939*^9, 3.8909938456284695`*^9}, {3.8909938944682283`*^9, 
   3.890993902665803*^9}, {3.8909939640862556`*^9, 3.8909939900348477`*^9}, {
   3.890994025742443*^9, 3.8909940575736265`*^9}, {3.890994146480085*^9, 
   3.890994146669649*^9}, {3.890994507334192*^9, 3.8909945936941805`*^9}, {
   3.8909946354682837`*^9, 3.890994652045141*^9}, {3.8909947354319*^9, 
   3.8909947793982277`*^9}, {3.8909948157708087`*^9, 3.890994873011228*^9}, {
   3.8909952763273125`*^9, 3.8909953283824463`*^9}, {3.890995372487257*^9, 
   3.8909955179780283`*^9}, {3.8909955837521577`*^9, 3.890995712664461*^9}, {
   3.8909957610925903`*^9, 3.8909958662322493`*^9}, {3.890995910892372*^9, 
   3.890995966591479*^9}, {3.8909960871391335`*^9, 3.8909960880568495`*^9}, {
   3.890996134570407*^9, 3.89099613568751*^9}, {3.890996181496214*^9, 
   3.890996204022863*^9}, {3.8909962345613966`*^9, 3.890996309144667*^9}, {
   3.8909963543747435`*^9, 3.8909964100086126`*^9}, {3.890996448867137*^9, 
   3.8909964501389275`*^9}, {3.8909964899367037`*^9, 3.890996643590911*^9}, {
   3.8909967159922285`*^9, 3.890996973633642*^9}, {3.890997055988861*^9, 
   3.8909970812998514`*^9}, {3.890997165932685*^9, 3.89099717063758*^9}, {
   3.8909973018682985`*^9, 3.890997376599899*^9}, 3.890997410100331*^9, {
   3.8909975189402866`*^9, 3.8909975208764453`*^9}, {3.8909975709016094`*^9, 
   3.890997724162681*^9}, {3.890997798163125*^9, 3.890997978132391*^9}, {
   3.890998055989809*^9, 3.890998154728313*^9}, {3.8909982315344305`*^9, 
   3.890998267658642*^9}, {3.8909983300104175`*^9, 3.8909983775248656`*^9}, {
   3.8909984264854617`*^9, 3.8909984315755444`*^9}, {3.8909986343839083`*^9, 
   3.890998653581501*^9}, {3.890998804162083*^9, 3.890998878597514*^9}, {
   3.891008768404775*^9, 3.891008818576131*^9}, {3.891008866455941*^9, 
   3.891008901298665*^9}, {3.891008974844755*^9, 3.8910090075856247`*^9}, {
   3.8910090662064915`*^9, 3.8910090959508357`*^9}, {3.8910091402211385`*^9, 
   3.891009148900914*^9}, {3.8910091830310946`*^9, 3.8910091944653854`*^9}, {
   3.8910092407510357`*^9, 3.891009241331257*^9}, {3.8910092727501965`*^9, 
   3.891009286673139*^9}, 3.8910096963840446`*^9, {3.8910098630814915`*^9, 
   3.8910099298391323`*^9}, {3.8910099637622795`*^9, 3.891009964142352*^9}, {
   3.8910115802347827`*^9, 3.891011580854376*^9}, {3.8910125808870535`*^9, 
   3.89101263851058*^9}, {3.8910126822585883`*^9, 3.8910126933650503`*^9}, {
   3.891012777326626*^9, 3.8910127776089287`*^9}, {3.8910128521205544`*^9, 
   3.8910128550359497`*^9}, {3.89101337826676*^9, 3.891013429883976*^9}, {
   3.8910134717705383`*^9, 3.891013537443392*^9}, {3.891013925896104*^9, 
   3.891013927582206*^9}, {3.8910140119250665`*^9, 3.8910141132913923`*^9}, {
   3.891014187406495*^9, 3.8910141907806544`*^9}, {3.8910155035813355`*^9, 
   3.891015517779789*^9}, {3.89101639621201*^9, 3.891016408323905*^9}, {
   3.8910237934773755`*^9, 3.891023811153926*^9}, {3.891023943596854*^9, 
   3.8910239439887056`*^9}, {3.8910240065604453`*^9, 
   3.8910240274168634`*^9}, {3.8910241170200973`*^9, 3.891024201626896*^9}, {
   3.8910539595895677`*^9, 3.8910539781368647`*^9}, {3.8910547108391824`*^9, 
   3.8910547128554225`*^9}, {3.89105554224943*^9, 3.8910555575155697`*^9}, {
   3.891055598922556*^9, 3.891055601610141*^9}, {3.89105888759682*^9, 
   3.891058889965515*^9}, 3.891142145421934*^9, 3.8911421912108817`*^9, {
   3.891142379310423*^9, 3.8911423794978447`*^9}, {3.8911424344220676`*^9, 
   3.8911424353127594`*^9}, {3.89114264437507*^9, 3.891142644781496*^9}, {
   3.8911426966681423`*^9, 3.8911426980588026`*^9}, {3.8911428741180468`*^9, 
   3.8911429249517574`*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"ac9b43ca-ac3a-4319-87ca-f2ce2af12135"],

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{"\[Theta]1", ",", 
   RowBox[{"\[Theta]1", " ", "\[Theta]2"}], ",", 
   RowBox[{"\[Theta]1", " ", "\[Theta]3", " ", 
    RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"%", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Total", "[", 
      RowBox[{"%", "^", "2"}], "]"}], "]"}]}], ")"}], "^", 
  RowBox[{"(", "2", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JacobianMatrix", "[", "%", "]"}], "//", "DefaultSimplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Times", "@@", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"%", "//", "Eigenvalues"}], ",", " ", "0"}], "]"}]}], "//", 
  "DefaultSimplify"}]}], "Input",
 CellChangeTimes->{{3.891059501919983*^9, 3.891059590243619*^9}, {
  3.891059804612683*^9, 3.8910598100175486`*^9}, {3.8910599040267253`*^9, 
  3.891059913657792*^9}, {3.891059952247405*^9, 3.891059956622304*^9}, {
  3.8910599929042788`*^9, 3.89106003181761*^9}, {3.891060066823137*^9, 
  3.8910600822155247`*^9}, {3.891060112608204*^9, 3.8910601620185537`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"02118cac-cc2d-4a60-8564-5a1e1e0433dd"],

Cell[BoxData[{
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Theta]2", "+", 
            RowBox[{
             SuperscriptBox["\[Theta]3", "2"], " ", 
             RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[Theta]2", "2"], "+", 
            RowBox[{
             SuperscriptBox["\[Theta]3", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}], 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "\[Theta]3", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[Theta]2", "2"], "+", 
            RowBox[{
             SuperscriptBox["\[Theta]3", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}]},
      {"0", 
       FractionBox[
        RowBox[{"2", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Theta]3", "2"], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Theta]2"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], ")"}]}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]2", "2"], "+", 
           RowBox[{
            SuperscriptBox["\[Theta]3", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]], 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "\[Theta]2", " ", "\[Theta]3", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[Theta]2", "2"], "+", 
            RowBox[{
             SuperscriptBox["\[Theta]3", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}]},
      {"0", 
       FractionBox[
        RowBox[{"2", " ", "\[Theta]3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[Theta]2", "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
           RowBox[{"\[Theta]2", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]2", "2"], "+", 
           RowBox[{
            SuperscriptBox["\[Theta]3", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]], 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]2", "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]2", "2"], "+", 
           RowBox[{
            SuperscriptBox["\[Theta]3", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "%", "]"}], ".", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "1"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ".", "%"}], "//", "DefaultSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"%", "//", "Eigenvalues"}], ",", " ", "0"}], "]"}], "//", 
    "DiagonalMatrix"}], "//", "Det"}], "//", "DefaultSimplify"}]}], "Input",
 CellChangeTimes->{{3.8910560727974315`*^9, 3.89105613775631*^9}, {
   3.891056189277873*^9, 3.891056215622718*^9}, {3.891056727938134*^9, 
   3.891056752575672*^9}, {3.891057648867509*^9, 3.891057680115673*^9}, {
   3.89105786641811*^9, 3.891057869777446*^9}, 3.8910580952022257`*^9, {
   3.8910581636479716`*^9, 3.8910581638976297`*^9}, {3.891058258577696*^9, 
   3.891058294765365*^9}, 3.891058956539137*^9, 3.8910590373217154`*^9, {
   3.8910591394965672`*^9, 3.891059166909191*^9}, 3.8910592256644554`*^9, 
   3.891059827817351*^9, {3.891142105416301*^9, 3.8911421177434807`*^9}, 
   3.8911421725193295`*^9, {3.8911422849168735`*^9, 3.891142308941097*^9}, {
   3.89114239274917*^9, 3.8911423930775857`*^9}, 3.89114260106312*^9, 
   3.8911426621889133`*^9, 3.891142716544918*^9, {3.891142752375903*^9, 
   3.8911428315709267`*^9}, {3.891142917856574*^9, 3.8911429314989805`*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"99e113f8-c2e8-49b3-8c84-a31a6db6e54c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Get", " ", "the", " ", "J", " ", "matrix", " ", "for", " ", "a", " ", 
    "given", " ", "transformation", " ", "p"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Par", "[", "1", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"Par", "[", "2", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"Par", "[", "3", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Tan", "[", 
        RowBox[{"Par", "[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"Par", "[", "2", "]"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"Par", "[", "3", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"Tan", "[", 
            RowBox[{"Par", "[", "3", "]"}], "]"}], "]"}]}], ")"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pars", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Par", "[", "i", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{
          RowBox[{"Universe", "[", "p", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PP", "[", "i", "]"}], "==", 
       RowBox[{"p", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"%", ",", " ", "pars"}], "]"}], "//", "Quiet"}], "//", 
     "Last"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pars", "/.", "%"}], "//", "Normal"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"%", ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PP", "[", "i", "]"}], "->", 
        RowBox[{"Par", "[", "i", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{
          RowBox[{"Universe", "[", "p", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianMatrix", "[", "%", "]"}], "//", "DefaultSimplify"}], "//",
     "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.891056357918106*^9, 3.891056370933728*^9}, {
  3.8910564152989554`*^9, 3.8910566081475773`*^9}, {3.891056640304948*^9, 
  3.8910567042122784`*^9}, {3.8910568236799936`*^9, 3.8910568531798773`*^9}, {
  3.891057368173745*^9, 3.891057445019989*^9}, {3.8910575762317743`*^9, 
  3.89105759724481*^9}, {3.8910577727013464`*^9, 3.8910577842607293`*^9}, {
  3.8911422204932814`*^9, 
  3.891142242900963*^9}},ExpressionUUID->"d6b3787f-c5f9-4b52-bb56-\
99f333739b45"]
},
WindowSize->{1141.2, 573.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.4 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"09678ca2-19ea-446c-92c5-587d9df706ae"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[1488, 33, 12466, 301, 1063, "Input",ExpressionUUID->"0939406d-c35b-479f-9024-0b74488d8234"],
Cell[13957, 336, 7347, 120, 173, "Input",ExpressionUUID->"c3afc09d-11cd-4097-ac54-a97d849b5ac2"],
Cell[21307, 458, 13571, 230, 337, "Input",ExpressionUUID->"ac9b43ca-ac3a-4319-87ca-f2ce2af12135"],
Cell[34881, 690, 1224, 28, 120, "Input",ExpressionUUID->"02118cac-cc2d-4a60-8564-5a1e1e0433dd"],
Cell[36108, 720, 6204, 160, 307, "Input",ExpressionUUID->"99e113f8-c2e8-49b3-8c84-a31a6db6e54c"],
Cell[42315, 882, 3121, 86, 226, "Input",ExpressionUUID->"d6b3787f-c5f9-4b52-bb56-99f333739b45"]
}
]
*)

